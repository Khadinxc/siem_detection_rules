#Name: malicious_file_over_unknown_ports
#Description: Checks my zeek.http data set which includes all http traffic within my homelab and looks for url extensions that have bat in them, and ports that do not equal 80.
#Definition
Custom query: event.dataset: "zeek.http" and  url.extension: bat and not destination.port: 80
Rule Type: Query
Timeline template: None
Suppress alerts by: source.ip
Suppress alerts for: 5m
If a suppression field is missing: Suppress and group alerts for events with missing fields
#Schedule
Runs every: 5m
Additional look-back time: 5m